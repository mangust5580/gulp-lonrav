# gulp‑lonrav — система сборки статических сайтов

Современная сборка на **Gulp 5** для создания статических сайтов: лендингов, многостраничных сайтов и шаблонов CMS.  
Проект ориентирован на производительность, гибкость и удобство разработки.

---

## Подходит для

- Лендингов и презентационных страниц
- Многостраничных корпоративных сайтов
- Статических сайтов, публикуемых на CDN или простом хостинге
- Шаблонов для CMS (с ручной интеграцией)

## Не подходит для

- Одностраничных или сервер‑ных приложений (React/Vue/Next.js/Nuxt и т.п.)
- Проектов, где лучше использовать Vite или другие инструментальные цепочки, ориентированные на фреймворки

---

## Требования

Для работы необходим **Node.js >= 20**.  
Также убедитесь, что ваша система управления пакетами (`npm`, `pnpm` или `yarn`) поддерживает указанную версию Node.

---

## Быстрый старт

### 1. Установка зависимостей

Установите необходимые пакеты любым менеджером:

```bash
npm install
# или
pnpm install
# или
yarn install
```

### 2. Запуск разработки

Запустите сервер разработки с автоматической пересборкой и Live Reload:

```bash
npm run dev
# или
pnpm dev
# или
yarn dev
```

Команда `dev`:

- компилирует шаблоны, стили и скрипты «на лету»;
- служит содержимое каталога `dist/` по адресу http://localhost:3000;
- отслеживает изменения файлов и обновляет страницу через BrowserSync.

### 3. Продакшен-сборка

Создайте оптимизированный релизный билд:

```bash
npm run build
```

Готовый сайт помещается в папку `public/`.  
Пути можно изменить в файле `config/paths.js` (см. [Конфигурация](#конфигурация)).

### 4. Просмотр продакшен-сборки

Для локального просмотра собранного сайта выполните:

```bash
npm run preview
```

---

## Доступные команды

- **`dev`** — сервер разработки с наблюдением за изменениями
- **`build`** — продакшен-сборка со всеми оптимизациями
- **`build:fast`** — ускоренная сборка (пропускает тяжёлые оптимизации, подробнее в разделе [Профили](#профили))
- **`preview`** — локальный просмотр папки `public/`
- **`clean`** — удаляет каталоги сборки (`dist/` и `public/`)
- **`check`** — линтинг + сборка (например, для CI)

---

## Структура проекта

```text
gulp-lonrav/
├── src/        # Исходные файлы (HTML/шаблоны, стили, скрипты, ассеты)
├── dist/       # Вывод сборки в режиме разработки
├── public/     # Вывод сборки в режиме продакшн
├── gulp/       # Реализации задач Gulp (разделены по модулям)
├── config/     # Конфигурация сборки (флаги, пути, параметры сайта)
├── gulpfile.js # Точка входа, регистрирующая задачи
└── package.json
```

Стандартное расположение файлов в **src**:

- `pages/` – страницы (HTML/шаблонные), из них компилируются конечные файлы
- `styles/` – исходники Sass/SCSS/PostCSS/Tailwind
- `scripts/` – JavaScript-модули, собираемые esbuild
- `assets/` – статические ресурсы (изображения, шрифты и др.), которые копируются без изменений
- `shared/` – общие компоненты, фрагменты и макеты

Вы можете изменять эту структуру, корректируя пути в `config/paths.js`.

---

## Возможности

### Шаблоны

Сборка поддерживает HTML-шаблонизацию «из коробки» и позволяет подключать разные движки.  
Поместите начальные шаблоны в `src/pages/`.  
По умолчанию обрабатываются обычные HTML-файлы, доступны include и layout.  
Чтобы использовать другой движок, установите соответствующий пакет и укажите его в настройке `templates.engine`.

### Стили

Используются [Sass/SCSS](https://sass-lang.com/) и [PostCSS](https://postcss.org/).  
Вы можете подключить [Tailwind CSS](https://tailwindcss.com/), установив пакет и выбрав движок `'tailwind'`.  
В продакшене CSS минифицируется и автопрефиксируется.

### JavaScript

Скрипты собираются [esbuild](https://esbuild.github.io/), что обеспечивает высокую скорость сборки.  
Поддерживается code splitting при использовании динамических импортов.

### Обработка ассетов

Изображения, SVG, шрифты, аудио и видео оптимизируются и копируются в сборку.  
Тяжёлые зависимости, например `sharp`, подгружаются лениво только при необходимости.

### Live Reload

Локальный сервер использует [BrowserSync](https://browsersync.io/) для автоматического обновления страницы.  
Изменения стилей внедряются без перезагрузки; остальные изменения вызывают reload.

### Инструменты качества

В сборку включены линтеры и форматтеры.  
- **ESLint** для JS/TS
- **Stylelint** для стилей
- **Prettier** для форматирования

Эти инструменты запускаются при старте `npm run dev` и в скрипте `check`.  
При необходимости вы можете настроить правила в `eslint.config.js` и `stylelint.config.js`.

### Дополнительные движки шаблонов

В поставку включены пайплайны для следующих движков (но они **не установлены по умолчанию**):

- [Pug](https://pugjs.org/)
- [EJS](https://ejs.co/)
- [Nunjucks](https://mozilla.github.io/nunjucks/)
- [Handlebars](https://handlebarsjs.com/)

Устанавливайте только то, что нужно вашему проекту.  
После установки выберите движок в конфиге:

```bash
npm i -D pug        # для шаблонов Pug
npm i -D ejs        # для EJS
npm i -D nunjucks   # для Nunjucks
npm i -D handlebars # для Handlebars
```

---

## Конфигурация

Поведение сборки настраивается через файлы в каталоге `config/`:

- **`config/features.js`** — включает и выключает опциональные модули (фавиконки, i18n, SVG-спрайт и др.).  
  Например, для поддержки мультиязычности установите `i18n.enabled = true` и добавьте файлы переводов в `src/locales/`.

- **`config/site.js`** — глобальные параметры сайта: `basePath`, режим ссылок, генерация sitemap и robots.txt.  
  Укажите `siteUrl`, если хотите корректную генерацию абсолютных URL.

- **`config/paths.js`** — перенастраивает пути исходников и вывода.  
  Здесь вы можете переименовать директории или изменить название папок сборки.

- **`config/images.js`** и **`config/svg.js`** — управляют качеством, форматами (`webp`, `avif`) и исключениями при оптимизации изображений и SVG.

Вы можете создать файл `config.js` в корне проекта и переопределить любые параметры, не меняя исходники сборки.  
Настройки будут объединены с базовыми при запуске.

---

## Включение i18n (мультиязычность)

Чтобы добавить поддержку нескольких языков:

1. Создайте файлы переводов в `src/locales/`, например `en.json` и `ru.json`.  
   Каждое значение — это объект пар ключ‑значение.  
   Например, содержимое `en.json`:

   ```json
   {
     "title": "Hello world",
     "description": "A modern build system"
   }
   ```

2. В `config/features.js` включите модуль i18n:

   ```js
   export const i18n = {
     enabled: true,
     defaultLocale: 'en',
     locales: ['en', 'ru'],
   };
   ```

3. В шаблонах используйте helper `$t('ключ')` для вывода строк.  
   Сборка создаст отдельную версию каждой страницы для каждого языка.

Подробности — на странице `/docs/index.html` после запуска `npm run dev`.

---

## Использование Tailwind CSS

Tailwind подключается через PostCSS.  
Чтобы его использовать:

1. Установите пакет:

   ```bash
   npm i -D tailwindcss
   ```

2. Создайте конфигурационный файл `tailwind.config.js` в корне проекта.  
   Описание параметров смотрите в [документации Tailwind](https://tailwindcss.com/docs/configuration).

3. Измените движок стилей в вашем конфиге:

   ```js
   // config.js
   export const styles = {
     engine: 'tailwind',
   };
   ```

Можно комбинировать Tailwind с Sass, импортируя сгенерированный файл `tailwind.css` в свои стили.

---

## Профили

Сборка поддерживает профили, позволяющие балансировать скорость и качество.  
Профиль выбирает, какие модули и оптимизации будут включены.

- **basic** — отключает тяжёлые оптимизации (конвертацию в AVIF, генерацию фавиконок, хеширование файлов).  
- **full** (по умолчанию) — включает всё.  

Выбрать профиль можно через переменную окружения или параметр CLI:

```bash
GULP_LONRAV_PROFILE=basic npm run build
# или
npm run build -- --profile basic
```

Вы можете определить собственный профиль в `config/profiles.js`.

---

## Документация

Подробная документация включена в проект.  
После запуска `npm run dev` откройте `/docs/index.html` в браузере, чтобы прочитать:

- Описание структуры проекта и принятых соглашений
- Пошаговые руководства по включению дополнительных возможностей (i18n, Tailwind, фавиконки)
- Ответы на часто задаваемые вопросы
- Примеры синтаксиса шаблонов и хелперов

Если вы предпочитаете читать на английском, используйте файл [README.md](README.md).

---

## Лицензия

MIT
